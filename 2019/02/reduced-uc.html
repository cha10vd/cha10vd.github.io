<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>Reducing the unit cell</title>


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
  <link href="/" rel="canonical" />

  <!-- Feed -->

  <link href="/theme/css/style.css" type="text/css" rel="stylesheet" />

  <!-- Code highlight color scheme -->
      <link href="/theme/css/code_blocks/github.css" rel="stylesheet">




  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->


  <link href="/2019/02/reduced-uc.html" rel="canonical" />

    <meta name="description" content="$$ \renewcommand{\vecprod}[2]{\vec{#1} \cdot \vec{#2}} \renewcommand{\vec}[1]{\textbf{#1}} \renewcommand{\eucnorm}[1]{\left| #1 \right|}...">

    <meta name="author" content="victor">

    <meta name="tags" content="Crystallography">
    <meta name="tags" content="Niggli">
    <meta name="tags" content="Krivy-Grueber">




<!-- Open Graph -->
<meta property="og:site_name" content="AD(P)HD"/>
<meta property="og:title" content="Reducing the unit cell"/>
<meta property="og:description" content="$$ \renewcommand{\vecprod}[2]{\vec{#1} \cdot \vec{#2}} \renewcommand{\vec}[1]{\textbf{#1}} \renewcommand{\eucnorm}[1]{\left| #1 \right|}..."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="/2019/02/reduced-uc.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2019-02-19 00:00:00+00:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="/author/victor">
  <meta property="article:publisher" content="https://www.facebook.com/vlnascimento" />
<meta property="article:section" content="Crystallography"/>
<meta property="article:tag" content="Crystallography"/>
<meta property="article:tag" content="Niggli"/>
<meta property="article:tag" content="Krivy-Grueber"/>
<meta property="og:image" content="/assets/images/page_header.jpg">

<!-- Twitter Card -->

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Reducing the unit cell",
  "headline": "Reducing the unit cell",
  "datePublished": "2019-02-19 00:00:00+00:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "victor",
    "url": "/author/victor"
  },
  "image": "/assets/images/page_header.jpg",
  "url": "/2019/02/reduced-uc.html",
  "description": "$$ \renewcommand{\vecprod}[2]{\vec{#1} \cdot \vec{#2}} \renewcommand{\vec}[1]{\textbf{#1}} \renewcommand{\eucnorm}[1]{\left| #1 \right|}..."
}
</script>
</head>
<!-- TODO : Body class -->
<body class="home-template">

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>

                  <li role="presentation"><a href="/category/classical-mechanics">Classical Mechanics</a></li>
                  <li class="nav-crystallography active" role="presentation"><a href="/category/crystallography">Crystallography</a></li>
                  <li role="presentation"><a href="/category/graphics">Graphics</a></li>
                  <li role="presentation"><a href="/category/gui-programming">GUI Programming</a></li>
                  <li role="presentation"><a href="/category/mathematics">Mathematics</a></li>
                  <li role="presentation"><a href="/category/miscellania">Miscellania</a></li>
                  <li role="presentation"><a href="/category/vim-scripting">Vim Scripting</a></li>

    </ul>
  </div>
</nav>
    <!-- Progressbar -->
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header id="post-header" class="has-cover">
      <div class="inner">
        <nav id="navigation">
            <span id="home-button" class="nav-button">
                <a class="home-button" href="/" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
            </span>
          <span id="menu-button" class="nav-button">
            <a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
          </span>
        </nav>
        <h1 class="post-title">Reducing the unit cell</h1>
        <!-- TODO : Proper class for headline -->
        <span class="post-meta">
                <a href="/author/victor">Victor Do Nascimento</a>
            | <time datetime="19 Feb 2019">19 Feb 2019</time>
        </span>
        <!-- TODO : Modified check -->
            <div class="post-cover cover" style="background-image: url('/assets/images/page_header.jpg')">
      </div>
    </header>

  <section id="wrapper">
    <a class="hidden-close"></a>

    <!-- Post content -->
    <main class="content" role="main">
        <article class="post">
        <div class="inner">
            <section class="post-content">
                <div class="math">$$
  \renewcommand{\vecprod}[2]{\vec{#1} \cdot \vec{#2}}
  \renewcommand{\vec}[1]{\textbf{#1}}
  \renewcommand{\eucnorm}[1]{\left| #1 \right|}
$$</div>
<p>The computation of reduced unit cells is an important building block for many crystallogaphic
applications, spanning from the comparison of structures in a database, through the analysis 
of ther void topologies to their refinement and optimization by methods such as periodic DFT.</p>
<p>The use of crystal structure prediction methods to sample lattice basis vector lengths and angles
often leads to the generation of very "flat" cells, which often prove to be unwieldly in optimization
and analysis.</p>
<p>It has been long understood that a given three-dimensional periodic lattice may be described by an
infinite number of certain combinations of non-collinear basis vectors.<sup id="fnref:fn1"><a class="footnote-ref" href="#fn:fn1" rel="footnote">1</a></sup></p>
<p>It is our goal to  define a cell based on the shortest three non-coplanar vectors.</p>
<p>A primitive cell may be defined in terms of a sequence of 6 real numbers:</p>
<div class="math">\begin{align} 
  \label{eq:lat_param_list} 
  A,B,C,\xi,\eta,\zeta
\end{align}</div>
<p>We call these the <em>characteristic</em> of the cell and define each as follows:</p>
<div class="math">\begin{align} 
  \label{eq:lat_param_def}
  \begin{array}{ l l l} 
    A   = \vec{a}^2,      &amp;    B = \vec{b}^2,       &amp; C     = \vec{c}^2       \\
    \xi = 2\vecprod{b}{c},&amp; \eta = 2\vecprod{a}{c}, &amp; \zeta = 2\vecprod{a}{b} \\
  \end{array}
\end{align}</div>
<p>We may store the lattice vectors as a matrix of their constituent cartesian components, here we 
choose  a column major convention:</p>
<div class="math">\begin{align} 
  \label{eq:} 
    \begin{bmatrix}
      a_{x} &amp; b_{x} &amp; c_{x} \\
      a_{y} &amp; b_{y} &amp; c_{y} \\
      a_{z} &amp; b_{z} &amp; c_{z} \\
    \end{bmatrix}
\end{align}</div>
<p>The first step in reducing a primitive cell is to standardize it. The criteria for standardization 
define the first set of conditions to be met. we require that the basis vector norms are arranged
in ascending order, such that:</p>
<div class="math">\begin{align} 
  \label{eq:len_ordering}
    A \leq B \leq C 
\end{align}</div>
<p>where there is degeneracy in basis vector lengths, we apply similar criteria to angles:</p>
<div class="math">\begin{align} 
  \label{eq:ang_ordering} 
    \eucnorm{\xi} \leq \eucnorm{\eta} \leq \eucnorm{\zeta} 
\end{align}</div>
<p>finally, in standardizing our cell representation, we also require that all angles are either defined
as <em>acute</em> or <em>oblique</em>:</p>
<div class="math">\begin{align} 
  \label{eq:ang_sign}
    \begin{array}{l l l l}
      \xi \gt  0, &amp; \eta \gt  0, &amp; \zeta \gt  0 &amp; \textrm{or} \\
      \xi \leq 0, &amp; \eta \leq 0, &amp; \zeta \leq 0 &amp;             \\
    \end{array} 
\end{align}</div>
<p>Choosing a preference for acute angles over obliques, we may carry out standardization of a unit-cell
by means of the following transformations:</p>
<ul>
<li>If <span class="math">\(A \gt B\)</span> or <span class="math">\((A = B\, \&amp;\&amp; \, \eucnorm{\xi} \gt \eucnorm{\eta})\)</span>:</li>
</ul>
<div class="math">\begin{align} 
  \label{eq:A1}
    \begin{bmatrix} 
      0 &amp; 1 &amp; 0 \\
      1 &amp; 0 &amp; 0 \\
      0 &amp; 0 &amp; 1 \\
    \end{bmatrix}
\end{align}</div>
<ul>
<li>If <span class="math">\(B \gt C\)</span> or <span class="math">\((B = C\, \&amp;\&amp; \, \eucnorm{\eta} \gt \eucnorm{\zeta})\)</span>:</li>
</ul>
<div class="math">\begin{align} 
  \label{eq:A2}
    \begin{bmatrix} 
      1 &amp; 0 &amp; 0 \\
      0 &amp; 0 &amp; 1 \\
      0 &amp; 1 &amp; 0 \\
    \end{bmatrix}
\end{align}</div>
<p>with <span class="math">\(A,B,C\)</span> in the right order, we proceed to standardize angles. Values <span class="math">\(i,j,k\)</span> are assigned according
to whether angles <span class="math">\(\alpha, \beta, \gamma\)</span> are geater, smaller or equal to <span class="math">\(\pi/2\)</span>.</p>
<ul>
<li>if <span class="math">\(\xi\eta\zeta \gt 0\)</span>,</li>
<li><span class="math">\(\eucnorm{\xi}   \rightarrow  \xi\)</span></li>
<li><span class="math">\(\eucnorm{\eta}  \rightarrow  \eta\)</span></li>
<li><span class="math">\(\eucnorm{\zeta} \rightarrow  \zeta\)</span></li>
<li>if <span class="math">\(\xi\eta\zeta \leq 0\)</span>, </li>
<li>-<span class="math">\(\eucnorm{\xi}   \rightarrow  \xi\)</span></li>
<li>-<span class="math">\(\eucnorm{\eta}  \rightarrow  \eta\)</span></li>
<li>-<span class="math">\(\eucnorm{\zeta} \rightarrow  \zeta\)</span></li>
</ul>
<div class="math">\begin{align} 
  \label{eq:A99}
    \begin{bmatrix} 
      1 &amp; 0 &amp; 0 \\
      0 &amp; 1 &amp; 0 \\
      0 &amp; 0 &amp; 1 \\
    \end{bmatrix}
\end{align}</div>
<div class="footnote">
<hr />
<ol>
<li id="fn:fn1">
<p>Grosse-Kunstleve, R.W.; Sauter, N.K.; Adams, P.D. <em>Acta Cryst.</em> <strong>2004</strong>, A60, 1-6 &#160;<a class="footnote-backref" href="#fnref:fn1" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "left",
        indent = "1em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' && location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' }, Macros: {} }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Reducing the unit cell&amp;url=/2019/02/reduced-uc.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=/2019/02/reduced-uc.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="ic ic-facebook"></i><span class="hidden">Facebook</span>
                    </a>
                    <a class="googleplus" href="https://plus.google.com/share?url=/2019/02/reduced-uc.html" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="ic ic-googleplus"></i><span class="hidden">Google+</span>
                    </a>
                    <div class="clear"></div>
                </div>

                <aside class="post-tags">
<a href="/tag/crystallography">Crystallography</a><a href="/tag/niggli">Niggli</a><a href="/tag/krivy-grueber">Krivy-Grueber</a>                </aside>

                <div class="clear"></div>

                <aside class="post-author">


                        <figure class="post-author-avatar">
                            <img src="/assets/images/avatar.png" alt="Victor Do Nascimento" />
                        </figure>
                    <div class="post-author-bio">
                        <h4 class="post-author-name"><a href="/author/victor">Victor Do Nascimento</a></h4>
                            <p class="post-author-about">PhD Candidade in Theoretical and Computational Chemistry at the University of Southampton</p>
                            <span class="post-author-location"><i class="ic ic-location"></i> Bournemouth</span>
                        <!-- Social linkes in alphabet order. -->
                            <span class="post-author-github"><a target="_blank" href="https://github.com/cha10vd"><i class="ic ic-link"></i> GitHub</a></span>
                            <span class="post-author-linkedin"><a target="_blank" href="https://www.linkedin.com/in/https://www.linkedin.com/in/victor-luis-do-nascimento-38a493103/"><i class="ic ic-link"></i> LinkedIn</a></span>
                    </div>
                    <div class="clear"></div>
                </aside>

                </section>


                <aside class="post-nav">
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
      <!-- TODO : Body class -->
    <div id="body-class" style="display: none;" class=""></div>

    <footer id="footer">
      <div class="inner">
        <section class="credits">


          <span class="credits-theme">Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a></span>
          <span class="credits-software">Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a></span>
        </section>
      </div>
    </footer>
  </section>

  <script type="text/javascript" src="/theme/js/script.js"></script>

<script type="text/javascript">
    var disqus_shortname = 'adphd-1';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>